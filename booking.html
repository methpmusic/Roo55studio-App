<!DOCTYPE html>
<html class="dark" lang="it"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Prenota la tua sessione</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#00FFA3",
            "background-dark": "#121212",
            "surface-dark": "#1E1E1E",
          },
          fontFamily: {
            "display": ["Space Grotesk", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.25rem",
            "lg": "0.5rem",
            "xl": "0.75rem",
            "2xl": "1rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>
<style>
    body {
      font-family: 'Space Grotesk', sans-serif;
    }
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-dark text-white">
<div class="relative flex h-auto min-h-screen w-full flex-col font-display group/design-root overflow-x-hidden">
<div id="header-placeholder"></div>
<div class="flex w-full flex-row items-center justify-center gap-2 py-5 px-4">
<div class="h-1 flex-1 rounded-full bg-primary"></div>
<div class="h-1 flex-1 rounded-full bg-gray-700"></div>
<div class="h-1 flex-1 rounded-full bg-gray-700"></div>
<div class="h-1 flex-1 rounded-full bg-gray-700"></div>
</div>
<div class="flex flex-wrap items-center justify-center gap-6 px-4 py-2">
<div class="flex w-full max-w-md flex-col gap-2 rounded-2xl bg-surface-dark p-4">
<div class="flex items-center pb-2">
<p class="text-white text-base font-bold leading-tight">Maggio 2024</p>
<div class="ml-auto flex items-center gap-2">
<button class="text-white flex size-8 items-center justify-center rounded-full hover:bg-white/10 transition-colors">
<span class="material-symbols-outlined text-xl">chevron_left</span>
</button>
<button class="text-white flex size-8 items-center justify-center rounded-full hover:bg-white/10 transition-colors">
<span class="material-symbols-outlined text-xl">chevron_right</span>
</button>
</div>
</div>
<div class="grid grid-cols-7 gap-y-1">
<p class="text-gray-400 text-xs font-bold tracking-wider flex h-10 w-full items-center justify-center">L</p>
<p class="text-gray-400 text-xs font-bold tracking-wider flex h-10 w-full items-center justify-center">M</p>
<p class="text-gray-400 text-xs font-bold tracking-wider flex h-10 w-full items-center justify-center">M</p>
<p class="text-gray-400 text-xs font-bold tracking-wider flex h-10 w-full items-center justify-center">G</p>
<p class="text-gray-400 text-xs font-bold tracking-wider flex h-10 w-full items-center justify-center">V</p>
<p class="text-gray-400 text-xs font-bold tracking-wider flex h-10 w-full items-center justify-center">S</p>
<p class="text-gray-400 text-xs font-bold tracking-wider flex h-10 w-full items-center justify-center">D</p>
<div class="h-10 w-full"></div>
<div class="h-10 w-full"></div>
<button class="h-10 w-full text-gray-500 text-sm font-medium leading-normal cursor-not-allowed">
<div class="flex size-full items-center justify-center rounded-full">1</div>
</button>
<button class="h-10 w-full text-gray-500 text-sm font-medium leading-normal cursor-not-allowed"><div class="flex size-full items-center justify-center rounded-full">2</div></button>
<button class="h-10 w-full text-gray-500 text-sm font-medium leading-normal cursor-not-allowed"><div class="flex size-full items-center justify-center rounded-full">3</div></button>
<button class="h-10 w-full text-gray-500 text-sm font-medium leading-normal cursor-not-allowed"><div class="flex size-full items-center justify-center rounded-full">4</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal relative">
<div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">5</div>
<div class="absolute bottom-1.5 left-1/2 -translate-x-1/2 h-1 w-1 rounded-full bg-primary"></div>
</button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal relative">
<div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">6</div>
<div class="absolute bottom-1.5 left-1/2 -translate-x-1/2 h-1 w-1 rounded-full bg-primary"></div>
</button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">7</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">8</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">9</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">10</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal relative">
<div id="day-11" class="flex size-full items-center justify-center rounded-full bg-primary text-black font-bold">11</div>
</button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal relative">
<div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">12</div>
<div class="absolute bottom-1.5 left-1/2 -translate-x-1/2 h-1 w-1 rounded-full bg-primary"></div>
</button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal relative">
<div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">13</div>
<div class="absolute bottom-1.5 left-1/2 -translate-x-1/2 h-1 w-1 rounded-full bg-primary"></div>
</button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">14</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">15</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal relative">
<div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">16</div>
<div class="absolute bottom-1.5 left-1/2 -translate-x-1/2 h-1 w-1 rounded-full bg-primary"></div>
</button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">17</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">18</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">19</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">20</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal relative">
<div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">21</div>
<div class="absolute bottom-1.5 left-1/2 -translate-x-1/2 h-1 w-1 rounded-full bg-primary"></div>
</button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">22</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">23</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">24</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">25</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal relative">
<div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">26</div>
<div class="absolute bottom-1.5 left-1/2 -translate-x-1/2 h-1 w-1 rounded-full bg-primary"></div>
</button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">27</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">28</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">29</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">30</div></button>
<button class="h-10 w-full text-white text-sm font-medium leading-normal"><div class="flex size-full items-center justify-center rounded-full hover:bg-white/10 transition-colors">31</div></button>
</div>
</div>
</div>
<h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-2">Seleziona un orario</h2>
<div class="flex gap-3 px-4 py-2 flex-wrap">
<button class="flex h-12 flex-1 items-center justify-center gap-x-2 rounded-xl border border-gray-700 bg-transparent px-4 text-center transition-colors hover:bg-gray-800">
<p class="text-white text-sm font-medium leading-normal">09:00</p>
</button>
<button class="flex h-12 flex-1 items-center justify-center gap-x-2 rounded-xl border-2 border-primary bg-primary/20 px-4 text-center">
<p class="text-primary text-sm font-bold leading-normal">11:00</p>
</button>
<button class="flex h-12 flex-1 items-center justify-center gap-x-2 rounded-xl border border-gray-700 bg-transparent px-4 text-center transition-colors hover:bg-gray-800">
<p class="text-white text-sm font-medium leading-normal">14:00</p>
</button>
</div>
<div class="flex gap-3 px-4 py-2 flex-wrap">
<button class="flex h-12 flex-1 cursor-not-allowed items-center justify-center gap-x-2 rounded-xl border border-gray-800 bg-transparent px-4 text-center text-gray-600">
<p class="text-sm font-medium leading-normal line-through">16:00</p>
</button>
<button class="flex h-12 flex-1 items-center justify-center gap-x-2 rounded-xl border border-gray-700 bg-transparent px-4 text-center transition-colors hover:bg-gray-800">
<p class="text-white text-sm font-medium leading-normal">18:00</p>
</button>
<div class="h-12 flex-1"></div>
</div>
<div class="p-4 mt-auto sticky bottom-0 bg-background-dark/80 backdrop-blur-sm">
<button class="w-full bg-primary text-black font-bold py-4 px-4 rounded-xl h-14 flex items-center justify-center hover:bg-primary/90 transition-colors">
        Continua
      </button>
</div>
</div>

<script>
    function getSelectedDate() {
        const selectedDateElement = document.querySelector('.bg-primary');
        if (!selectedDateElement) {
            return null;
        }
        const day = selectedDateElement.textContent;
        const monthYear = document.querySelector('.text-white.text-base.font-bold.leading-tight').textContent;
        const month = monthYear.split(' ')[0];
        const year = monthYear.split(' ')[1];

        // Convert month name to number
        const monthNames = ["Gennaio", "Febbraio", "Marzo", "Aprile", "Maggio", "Giugno",
                            "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre"];
        const monthIndex = monthNames.indexOf(month) + 1;
        const monthString = monthIndex < 10 ? '0' + monthIndex : monthIndex;
        const dayString = day.length < 2 ? '0' + day : day;

        return `${year}-${monthString}-${dayString}`;
    }

    function fetchAvailableSlots(date) {
        fetch(`/available_slots/${date}`)
            .then(response => response.json())
            .then(slots => {
                const slotsContainer = document.querySelector('.flex.gap-3.px-4.py-2.flex-wrap');
                slotsContainer.innerHTML = '';
                slots.forEach(slot => {
                    const button = document.createElement('button');
                    button.className = 'flex h-12 flex-1 items-center justify-center gap-x-2 rounded-xl border border-gray-700 bg-transparent px-4 text-center transition-colors hover:bg-gray-800';
                    button.innerHTML = `<p class="text-white text-sm font-medium leading-normal">${slot}</p>`;
                    button.onclick = () => {
                        document.querySelectorAll('.flex.gap-3.px-4.py-2.flex-wrap button').forEach(btn => {
                            btn.classList.remove('border-primary', 'bg-primary/20');
                            btn.classList.add('border-gray-700');
                        });
                        button.classList.add('border-primary', 'bg-primary/20');
                        button.classList.remove('border-gray-700');
                    };
                    slotsContainer.appendChild(button);
                });
            });
    }

    document.addEventListener('DOMContentLoaded', function () {
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-placeholder').innerHTML = data;
                fetch('/check_login')
                    .then(response => response.json())
                    .then(data => {
                        const userActions = document.getElementById('user-actions');
                        if (data.logged_in) {
                            userActions.innerHTML = `<button class="text-white flex size-10 items-center justify-center rounded-full bg-surface-dark" onclick="logout()"><span class="material-symbols-outlined text-2xl">logout</span></button>`;
                        } else {
                            userActions.innerHTML = `<a href="login.html" class="text-white flex size-10 items-center justify-center rounded-full bg-surface-dark"><span class="material-symbols-outlined text-2xl">login</span></a>`;
                        }
                    });
            });

        const calendarDays = document.querySelectorAll('.grid.grid-cols-7.gap-y-1 button');
        calendarDays.forEach(day => {
            day.addEventListener('click', () => {
                calendarDays.forEach(d => {
                    const div = d.querySelector('div');
                    div.classList.remove('bg-primary', 'text-black', 'font-bold');
                });
                const div = day.querySelector('div');
                div.classList.add('bg-primary', 'text-black', 'font-bold');

                const selectedDate = getSelectedDate();
                if (selectedDate) {
                    fetchAvailableSlots(selectedDate);
                }
            });
        });

        const initialDate = getSelectedDate();
        if (initialDate) {
            fetchAvailableSlots(initialDate);
        }
    });

    function bookSession() {
        const selectedTimeElement = document.querySelector('.border-primary.bg-primary/20 p');
        if (!selectedTimeElement) {
            alert('Please select a time slot.');
            return;
        }
        const selectedTime = selectedTimeElement.textContent;

        const selectedDateElement = document.querySelector('.bg-primary');
        if (!selectedDateElement) {
            alert('Please select a date.');
            return;
        }
        const selectedDate = getSelectedDate();
        if (!selectedDate) {
            alert('Please select a date.');
            return;
        }

        fetch('/book', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ date: selectedDate, time: selectedTime })
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message);
            if (data.message === 'Booking successful') {
                window.location.reload();
            }
        });
    }

    function logout() {
        fetch('/logout')
        .then(response => {
            if (response.ok) {
                window.location.href = 'login.html';
            }
        });
    }
</script>
</body></html>